---
title: "APA Tables and Figures Generation"
output:
  word_document:
    reference_docx: assets/apa.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(psych)
library(ggplot2)
library(sjPlot)
```

## Tables

Several packages support making beautiful tables with R, such as

* [xtable](https://cran.r-project.org/web/packages/xtable/)
* [stargazer](https://cran.r-project.org/web/packages/stargazer/)
* [pander](http://rapporter.github.io/pander/)
* [tables](https://cran.r-project.org/web/packages/tables/)

Here, we use the kable function from the knitr package to generate our table.

_Table 1._

```{r table, echo=FALSE}
descriptives <- describe(iris)[,c("n", "mean", "sd", "skew", "kurtosis", "se")]
knitr::kable(descriptives)
```

## Figures

Plots generated by the R code chunks in an R Markdown document can be automatically 
inserted in the output file. The size of the figure can be controlled with the `fig.height`
and `fig.width` arguments.

To embed plots, for example:

ggplot(data = iris, aes(Sepal.Length, Sepal.Width)) + geom_point(aes(colour = (Species))) + geom_smooth(method = "lm")



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Advanced Tables with Stargazer

This requires manually copy and pasting from the website into word, but hey, it works!

```{r regression, eval=T, echo=F, include=T}
## 2 OLS models
lm1 <- lm(rating ~ complaints + privileges + learning + raises + critical, data=attitude)
lm2 <- lm(rating ~ complaints + privileges + learning, data=attitude)

sjt.lm(lm1,lm2, file="assets/output.html", remove.spaces = T, depvar.labels = c("Overall Rating","High Rating"), pred.labels = c("Handling of Complaints","No Special Privileges","Opportunity to Learn","Performance-Based Raises","Too Critical","Advancement"))

```

```{r regressionoutput, echo=FALSE, include=FALSE}
htmltools::includeHTML("assets/output.html")
```